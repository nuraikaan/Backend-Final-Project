<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>My Cart â€“ Cosmo</title>
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
    rel="stylesheet"
  />
  <link rel="stylesheet" href="style.css" />
</head>
<body class="bg-light">
<nav class="navbar navbar-expand-lg bg-white shadow-sm">
  <div class="container">
    <a class="navbar-brand text-pink fw-bold" href="catalog.html">Cosmo</a>
    <ul class="navbar-nav ms-auto">
      <li class="nav-item"><a class="nav-link" href="catalog.html">Catalog</a></li>
      <li class="nav-item"><a class="nav-link" href="favorites.html">Favorites</a></li>
      <li class="nav-item"><a class="nav-link" href="cart.html">Cart</a></li>
      <li class="nav-item"><a class="nav-link" href="#" onclick="logout()">Logout</a></li>
    </ul>
  </div>
</nav>

<div class="container my-5">
  <h2>ðŸ›’ My Cart</h2>
  <div id="cart-items" class="row g-4"></div>
</div>

<script src="app.js"></script>
<script>
async function loadCart() {
  const res = await fetchWithAuth(`${API}/cart`);
  const items = await res.json();

  const c = document.getElementById('cart-items');
  c.innerHTML = '';

  if (!items.length) {
    c.innerHTML = '<p class="text-muted">Cart is empty</p>';
    return;
  }

  items.forEach(i => {
    const col = document.createElement('div');
    col.className = 'col-md-4';
    col.innerHTML = `
      <div class="card h-100">
        <img src="${i.product.imageUrl}" class="card-img-top">
        <div class="card-body">
          <h5>${i.product.name}</h5>
          <p>$${i.product.price}</p>
          <p>Quantity: ${i.quantity}</p>
          <button class="btn btn-danger btn-sm"
            onclick="removeFromCart('${i.product._id}')">
            Remove
          </button>
        </div>
      </div>
    `;
    c.appendChild(col);
  });
}

async function removeFromCart(id) {
  await fetchWithAuth(`${API}/cart/${id}`, { method: 'DELETE' });
  loadCart();
}

document.addEventListener('DOMContentLoaded', loadCart);
</script>

</body>
</html>